<!doctype html>
<html>
  <head>
    <title>My first VR site</title>
		<script src="https://aframe.io/releases/0.5.0/aframe.min.js"></script>
  </head>
  <body>
    <a-scene>
			<a-sky id="skybox"></a-sky>
			<a-camera id="target" position="0 1.4 0">
				    <a-entity cursor="fuse: true; fuseTimeout: 3000" 
											position="0 0 -1" 
											geometry="primitive: ring" 
											scale="0.03 0.03 0.03" 
											material="color: white; shader: flat">
							<a-animation begin="cursor-fusing" easing="ease-in" attribute="scale" 
													 fill="none" from="0.03 0.03 0.03" to="0.001 0.001 0.001"></a-animation>
						</a-entity>
			</a-camera>
		</a-scene>

		<script type="text/javascript">
			var room = 'all';
			var match = location.search.match(/room=(.*?)(&|$)/);
			if(match) {
			    room = decodeURIComponent(match[1]);
			}
			
   	  var scenes = [{
					'scene_id': '000',
					'spheres': [
							{'rad':0.75, 'next_id':'001'},
							{'rad':0.92, 'next_id':'002'}
					],
					'img_name':'img/001.JPG'
 			},
										{
					'scene_id': '001',
					'spheres': [
							{'rad':0.75, 'next_id':'000'},
							{'rad':0.92, 'next_id':'002'}
					],
					'img_name':'img/002.JPG'
										},
										{
					'scene_id': '002',
					'spheres': [
							{'rad':0.5, 'next_id':'000'},
					],
					'img_name':'img/003.JPG'
										}
									 ];

      createScene (scenes[Number(room)]);

      function createScene (scene) {
		      // Change skybox
					var skyBox = document.getElementById ('skybox');					
					skyBox.setAttribute ('src',scene['img_name']);

					// Add Spheres
					var spheres = scene['spheres'];
					for (var i=0; i < spheres.length; i++) {
							createSphere(spheres[i]['rad'], spheres[i]['next_id']);
					}
			}	

      function createSphere (rad, next_id) {
					rad = ((rad -0.75) * 2 + 3/2) * Math.PI;
					
					var scene = document.querySelector('a-scene');
					var sphere = document.createElement('a-sphere');
					var position_str = String(Math.cos(rad)*7) + ' 3 ' + String(Math.sin(rad)*5);

					sphere.setAttribute('color', '#666666');
					sphere.setAttribute('radius', '0.5');
					sphere.setAttribute('next_id', next_id);
					sphere.setAttribute('class', 'open_sphere');
					sphere.setAttribute('position', position_str);
					sphere.setAttribute('onclick','location.href=\'?room='+String(next_id)+'\';');

					scene.appendChild(sphere);
			}

      /*
      function deleteAllSpheres () {
					var spheres = document.querySelectorAll('a-sphere');
					for (var i=0; i < spheres.length; i++) {
							spheres[i].parentNode.removeChild(spheres[i]);
					}
					global_spheres = [];
			}
      */
		</script>
  </body>
</html>
